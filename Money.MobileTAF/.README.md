
# Mobile Automation Environment Setup Guide

This document provides step-by-step instructions to set up your Android emulator environment, Appium, .NET SDK 9, and Node.js for mobile automation testing on both Windows and macOS.

---


## Table of Contents

### The Set Up

* [Android Emulator Setup: Windows](#android-emulator-setup-windows)
* [Android Emulator Setup: macOS](#android-emulator-setup-macos)
* [Appium](#appium)
* [Install .NET SDK Version 9](#install-net-sdk-version-9)
* [Node.js Installation (Windows and macOS)](#node.js-installation-windows-and-macos)

### How To Run Tests

* [How To Run Tests](#how-to-run-tests)

### Approach

* [Approach](#approach)

---

## **Android Emulator Setup: Windows**

### **1. Download Android Command Line Tools**

* **Action:** Go to the official Android Studio download page and get the "Command line tools only" ZIP file for Windows.
  * **Download URL:** [https://developer.android.com/tools/releases/platform-tools#downloads](https://developer.android.com/tools/releases/platform-tools#downloads)
  * **File Name Example:** `commandlinetools-win-...zip`

### **2. Set Up Android SDK Directory & Extract Tools**

```cmd
mkdir C:\Android\sdk
```
Extract the zip into the above directory and rename the inner `cmdline-tools` folder to `latest` so it becomes:

```
C:\Android\sdk\cmdline-tools\latest\bin\sdkmanager.bat
```

### **3. Configure Environment Variables**

```cmd
setx ANDROID_HOME "C:\Android\sdk" /M
setx Path "%Path%;%ANDROID_HOME%\cmdline-tools\latest\bin;%ANDROID_HOME%\platform-tools;%ANDROID_HOME%\emulator" /M
```

Open a new prompt and verify:

```cmd
echo %ANDROID_HOME%
sdkmanager --version
```

### **4. Accept SDK Licenses**

```cmd
sdkmanager --licenses
```

### **5. Install Required SDK Packages**

```cmd
sdkmanager "platform-tools" "build-tools;34.0.0" "platforms;android-34" "system-images;android-34;google_apis_playstore;x86_64"
```

### **6. Create an Android Virtual Device (AVD)**

```cmd
avdmanager create avd -n MyTestEmulator -k "system-images;android-34;google_apis_playstore;x86_64" -d pixel_5
```

### **7. Start the Android Emulator**

```cmd
emulator -avd MyTestEmulator
emulator -avd MyTestEmulator -no-window
```

---

## **Android Emulator Setup: macOS**

### **1. Download Android Command Line Tools**

* **Download URL:** [https://developer.android.com/tools/releases/platform-tools#downloads](https://developer.android.com/tools/releases/platform-tools#downloads)
* **File Name Example:** `commandlinetools-mac-...zip`

### **2. Set Up Android SDK Directory & Extract Tools**

```bash
mkdir -p ~/Android/sdk
```

Extract the zip into the folder and rename `cmdline-tools` to `latest`:

```
~/Android/sdk/cmdline-tools/latest/bin/sdkmanager
```

### **3. Configure Environment Variables**

Edit your shell config (e.g., `~/.zshrc`):

```bash
export ANDROID_HOME=$HOME/Android/sdk
export ANDROID_SDK_ROOT=$ANDROID_HOME
export PATH=$PATH:$ANDROID_HOME/cmdline-tools/latest/bin:$ANDROID_HOME/platform-tools:$ANDROID_HOME/emulator
source ~/.zshrc
```

Verify:

```bash
echo $ANDROID_HOME
sdkmanager --version
```

### **4. Accept SDK Licenses**

```bash
sdkmanager --licenses
```

### **5. Install Required SDK Packages**

```bash
sdkmanager "platform-tools" "build-tools;34.0.0" "platforms;android-34" "system-images;android-34;google_apis_playstore;x86_64"
```

### **6. Create an Android Virtual Device (AVD)**

```bash
avdmanager create avd -n MyTestEmulator -k "system-images;android-34;google_apis_playstore;x86_64" -d pixel_5
```

### **7. Start the Android Emulator**

```bash
emulator -avd MyTestEmulator
emulator -avd MyTestEmulator -no-window
```

---

## **Appium**

### macOS

```bash
brew install node
npm install -g appium
appium --version
```

### Windows

Open PowerShell as Administrator:

```powershell
winget install OpenJS.NodeJS.LTS -e
npm install -g appium
appium --version
```

---

## **Install .NET SDK Version 9**

### macOS

```bash
brew tap isen-ng/dotnet-sdk-versions
brew install --cask dotnet-sdk9
export PATH="/usr/local/share/dotnet:$PATH"
dotnet --version
```

> If not found via Homebrew, download manually: https://dotnet.microsoft.com/en-us/download/dotnet/9.0

### Windows

Open PowerShell as Administrator:

```powershell
winget search Microsoft.DotNet.SDK.9
winget install Microsoft.DotNet.SDK.9
dotnet --version
```

---

## **Node.js Installation (Windows and macOS)**

### **1. Download & Install Node.js**

* **URL:** [https://nodejs.org/en/download](https://nodejs.org/en/download)

### **2. Verify Installation**

```bash
node -v
npm -v
```

---


## **How To Run Tests**
### **1. Clone The Repo**

- Create a folder (e.g src)
- Open a terminal and Clone the repository in the folder created:

```bash
git clone https://github.com/AlejandroAreiza/AlejandroAreiza_N26.git
cd AlejandroAreiza_N26/Money.MobileTAF
```

### **2. Config Environment**
Follow these steps to run your mobile tests against a local Android emulator or physical device.

**List Available Android Devices**

Use the Android SDK’s ADB tool to list all connected/emulated devices:

```bash
adb devices
```

You should see a list like:

```
List of devices attached
emulator-5554   device
```

To list available emulator images:

```bash
emulator -list-avds
```

To start an emulator:

```bash
emulator -avd <your_avd_name>
```

You can also list emulator images with more info:

```bash
avdmanager list avd
```

---

**Edit `desiredCapabilities.json`**

Update your desired capabilities file (usually located at `config/TestLaunchConfigData.json`) with the correct **deviceName**, **platformVersion**, and **platformName**.

```json
{
  "platformName": "Android",
    "platformVersion": "16",
    "DeviceName": "sdk_gphone64_arm64",
    "AppPackage": "com.monefy.app.lite",
    "AppActivity": "com.monefy.activities.main.MainActivity_",
    "AutomationName": "UiAutomator2",
    "udid": "emulator-5554"
}
```

| Field            | Description                                |
|------------------|--------------------------------------------|
| `platformName`   | Use `"Android"` or `"iOS"`                 |
| `platformVersion`| Android OS version (e.g., `"11.0"`)        |
| `deviceName`     | Use the value returned from `adb devices`  |
| `app`            | Path to your APK or IPA file               |
| `noReset`        | `true` keeps app state between sessions    |

---

### **3. Run Tests via CLI**

 --filter follows the [dotnet test](https://learn.microsoft.com/en-us/dotnet/core/tools/dotnet-test?tabs=dotnet-test-with-vstest]) run specification for filtering testcases
```bash
dotnet test \
  --logger:"console;verbosity=detailed" \
  --results-directory ./TestResults \
  --filter "Name=DateFromDeletedAccount_ShouldNotBeReflected_OnOtherAccounts" \
  -- TestAdapterPath:. AllureConfig.Directory=./TestResults/allure-results
```

**View Test Results**
```
docker run -d \
  --name allure \
  -p 5050:5050 \
  -v "$(pwd)/TestResults/allure-results:/app/allure-results" \
  frankescobar/allure-docker-service
```

---

## **Approach**

#### Mobile Test Automation Framework (iOS & Android)

A cross-platform mobile automation framework built with .NET, Appium, and NUnit. Supports native Android/iOS apps, with flexible execution.

---

###  Features

- Supports both Android and iOS using Appium
- Driver Factory pattern to handle platform instantiation
- Test execution managed via NUnit
- Wrapper classes over mobile elements for clean interactions
- Page Object Model (POM) for maintainability
- Logging via Nlog per test


### Project Structure

MobileTestFramework/
├── Config.Insfrastruture/ # Driver config, factory logic
├── Monefy.Domaind/ # POM-based screens with wrappers
├── Monefy.Tests/ # NUnit test cases + BaseTest
├── capabilities.json # Appium desired capabilities

I architected this mobile test framework to emphasize **platform abstraction**, **clean test readability**, and **environment flexibility**.

### Tech Stack & Design Patterns

| Component           | Why I Chose It                                                                          |
|--------------------|-------------------------------------------------------------------------------------------|
| **C# + .NET**       | Familiar, type-safe, and integrates well with NUnit and Appium                           |
| **Appium**          | Open-source and supports both Android and iOS                                            |
| **NUnit**           | Lightweight and allows custom test categorization via `[Category()]`                    |
| **Driver Factory Pattern** | Supports platform switching (Android/iOS) using runtime config                            |
| **Wrapper over Mobile Elements** | Abstracts element interactions (clicks, text) for consistent behavior             |
| **Page Object Model (POM)** | Encapsulates UI logic to improve maintainability and reuse                          |
| **Abstraction Layer (`IMobileDriver`)** | Decouples driver creation from test logic                                 |
| **Logging (Nlog)** | Generates structured logs per test run in timestamped files                           |

The use of **clean architecture principles** and **deferred element lookup** ensures test reliability in dynamic mobile UI contexts. The **custom element wrappers** reduce duplication and enable richer assertions and logging for each interaction.
