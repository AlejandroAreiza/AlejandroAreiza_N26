
# PetStore API Test Automation Framework - Docker Compose Usage

This document explains how to use Docker Compose to run the PetStore API Test Automation Framework containerized with all dependencies.

---

## Prerequisites

- Docker installed on your machine  
  [Get Docker here](https://docs.docker.com/get-docker/)  
- Docker Compose installed (usually included with Docker Desktop)  
- Basic knowledge of terminal/command line usage  

---

## Setup

- Create a folder (e.g src) and give it permission in Docker (Ensure your local folders have appropriate permissions if mounting volumes)
  - Navigate to Settings > Resources > File sharing > Add Folder
- Clone the repository in the folder created:

```bash
git clone https://github.com/AlejandroAreiza/AlejandroAreiza_N26.git
cd AlejandroAreiza_N26/PetStore.ApiTAF


```

---

### Running Tests with Docker Compose

#### Start the test environment, dependencies and run tests:

```bash
docker-compose up -d 
```

This command will:

- Build the Docker image(s) if not already built  
- Start the container(s) running the test automation framework  
- Execute tests automatically as defined in the container entrypoint  

---

### Running Tests by Passing Parameters to Docker Compose

You can customize test execution by passing environment variables to Docker Compose.

#### Common Parameters:

| Variable Name         | Description                                             | Default Value
|------------------------|---------------------------------------------------------|--------------------------------|
| `TEST_PROJECT`         | Test project name to execute                            | `pet`                          
| `TEST_FILTER`          | NUnit test filter expression (e.g., Name~TestName) |     `"Category=Regression"` 


##### Example: Running only sanity tests

```bash
docker-compose up -d petstore-api allure
docker-compose run --rm \
  -e TEST_PROJECT=pet \
  -e TEST_FILTER="Name~GivenValidPetId_WhenDeletingPet_ShouldReturnsSuccess" \
  petstore-api-taf
```
This command will:

- Build the Docker image(s) if not already built  
- Start the container(s) petstore api and allure 
- Execute tests automatically as defined by the params
---
### Viewing allure Reports

Once test are been executed go to [Allure Report Page](http://localhost:5050/allure-docker-service/projects/default/reports/latest/index.html?redirect=false) 

---

### Stopping and Cleaning Up

To stop running containers:

```bash
docker-compose down
```

To remove all containers, networks, and volumes created by Docker Compose:

```bash
docker-compose down -v
```

---

## Approach

#### Pet API Test Automation Framework

This is a .NET-based test automation framework designed to test a RESTful Pet API. It is scalable, modular, and containerized for CI/CD execution.

- REST API testing using Refit (typed HTTP clients)
- Fluent Builder Pattern for test data creation
- NUnit as the test runner
- Gherkin-style method naming for test clarity
- Structured and reusable test layers
- Data-driven testing via JSON
- Custom logging per test using log4net
- Allure test reporting
- Portable execution with Docker
- CI/CD ready (GitHub Actions / Jenkins)

#### Project Structure

PetApiTestFramework/
├── config.infrastructure/ # Global config + logging
├── pet.domain/ # API client interfaces and models
├── pet.tests/ # Test cases and BaseTest setup
├── Dockerfile # Multistage Docker build
├── docker-compose.yml # Test orchestration
└── entrypoint.sh # Entrypoint for test execution



I emphasized **clarity**, **reusability**, and **scalability**, using a layered architecture and modern design patterns.

#### Tech Stack & Design Patterns

| Component       | Why We Chose It                                                                 |
|----------------|----------------------------------------------------------------------------------|
| **C# + .NET**   | Strong ecosystem, async/await support, and seamless integration with Refit & NUnit |
| **Refit**       | Simplifies REST API calls using declarative interfaces (cleaner than `HttpClient`) |
| **NUnit**       | Lightweight, powerful, and widely supported testing framework                   |
| **Fluent Builder Pattern** | Makes test data construction readable, reusable, and fluent              |
| **Page Object Model (POM)** | Encapsulates API endpoint logic to promote reusability and readability |
| **Data-Driven Testing** | Parameterized tests improve coverage and maintainability      |
| **Docker**      | Enables test isolation and consistent local/CI execution                         |
| **Logging (Nlog)** | Per-test logs stored separately with timestamped file names                  |
| **Allure Reporting** | Provides beautiful, interactive HTML test reports                          |

We also follow a **clear separation of concerns**:
- **Domain layer:** Holds API models and client definitions.
- **Test layer:** Contains test logic, assertions, and structured naming.
- **Config layer:** Deals with runtime configuration, logging, and test setup.
- 
This design allows easy scalability, team collaboration, and CI/CD integration while keeping the test logic expressive and maintainable


---
